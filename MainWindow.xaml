<Window x:Class="SimGamepad.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SimGamepad"
        Width="520"
        Height="600"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        WindowStyle="None"
        AllowsTransparency="True">

    <!-- Root: semi-transparent so blur shows through (glassmorphism) -->
    <Border Background="{StaticResource GlassBgOverlayBrush}"
            CornerRadius="24"
            BorderThickness="1"
            BorderBrush="{StaticResource GlassBorderBrush}"
            Margin="0">
        <Border.Effect>
            <DropShadowEffect BlurRadius="40" ShadowDepth="0" Opacity="0.4" Color="Black"/>
        </Border.Effect>

        <Grid Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- TITLE BAR - glass, macOS traffic lights left + drag -->
            <Border Grid.Row="0"
                    Background="{StaticResource GlassCardBrush}"
                    CornerRadius="18,18,0,0"
                    Padding="14,8"
                    Margin="-24,-24,-24,0"
                    BorderThickness="1,1,1,0"
                    BorderBrush="{StaticResource GlassBorderBrush}">
                <Grid>
                    <Border Background="Transparent"
                            MouseLeftButtonDown="Window_MouseLeftButtonDown"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"/>
                    <!-- macOS-style: Close, Minimize, Maximize (left, small circles) -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="2,0,0,0">
                        <Button x:Name="BtnClose" Click="Close_Click" Style="{StaticResource MacTrafficLightButtonStyle}"
                                ToolTip="Close" Background="{StaticResource MacCloseBrush}" Margin="0,0,6,0"/>
                        <Button x:Name="BtnMinimize" Click="Minimize_Click" Style="{StaticResource MacTrafficLightButtonStyle}"
                                ToolTip="Minimize" Background="{StaticResource MacMinimizeBrush}" Margin="0,0,6,0"/>
                        <Button x:Name="BtnMaximize" Click="Maximize_Click" Style="{StaticResource MacTrafficLightButtonStyle}"
                                ToolTip="Maximize" Background="{StaticResource MacMaximizeBrush}"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- TOP STATUS BAR - glass panel + draggable -->
            <Border Grid.Row="1"
                    Background="{StaticResource GlassCardBrush}"
                    CornerRadius="18"
                    Padding="20,16"
                    Margin="0,0,0,20"
                    BorderThickness="1"
                    BorderBrush="{StaticResource GlassBorderBrush}"
                    MouseLeftButtonDown="Window_MouseLeftButtonDown">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.15" Color="Black"/>
                </Border.Effect>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <StackPanel>
                        <TextBlock Text="Connection Mode"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   FontSize="12"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding ActiveModeText}"
                                   Foreground="{StaticResource AccentWifiBrush}"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Margin="0,2,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                        <TextBlock Text="Status"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   FontSize="12"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding StatusText}"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Margin="0,2,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- MODE BUTTONS - glass cards -->
            <StackPanel Grid.Row="2"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Margin="0,0,0,24">

                <!-- WIFI -->
                <Border Width="96" Height="96"
                        Background="{StaticResource GlassCardBrush}"
                        CornerRadius="24"
                        Margin="8"
                        BorderThickness="1"
                        BorderBrush="{StaticResource GlassBorderBrush}"
                        MouseLeftButtonDown="Wifi_Click"
                        Cursor="Hand">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="24" ShadowDepth="0" Color="#00E5A0" Opacity="{Binding WifiGlowOpacity}"/>
                    </Border.Effect>
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Viewbox Width="36" Height="36" Margin="0,0,0,4">
                            <Path Data="M12 5C7 5 3 9 3 9L5 11C5 11 8 8 12 8C16 8 19 11 19 11L21 9C21 9 17 5 12 5z M12 11C9.5 11 7.5 13 7.5 13L9.5 15C9.5 15 11 14 12 14C13 14 14.5 15 14.5 15L16.5 13C16.5 13 14.5 11 12 11z M12 17C11.45 17 11 17.45 11 18C11 18.55 11.45 19 12 19C12.55 19 13 18.55 13 18C13 17.45 12.55 17 12 17z"
                                  Fill="{StaticResource TextPrimaryBrush}"
                                  Stretch="Uniform"/>
                        </Viewbox>
                        <TextBlock Text="Wi-Fi" Foreground="{StaticResource TextPrimaryBrush}" FontSize="13" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- BLUETOOTH -->
                <Border Width="96" Height="96"
                        Background="{StaticResource GlassCardBrush}"
                        CornerRadius="24"
                        Margin="8"
                        BorderThickness="1"
                        BorderBrush="{StaticResource GlassBorderBrush}"
                        MouseLeftButtonDown="Bluetooth_Click"
                        Cursor="Hand">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="24" ShadowDepth="0" Color="#5FC9FF" Opacity="{Binding BluetoothGlowOpacity}"/>
                    </Border.Effect>
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Viewbox Width="36" Height="36" Margin="0,0,0,4">
                            <Path Data="M17.71 7.71L12 2h-1v7.59L6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 11 14.41V22h1l5.71-5.71-4.3-4.29 4.3-4.29zM13 5.83l1.88 1.88L13 9.59V5.83zm0 12.34v-3.76l1.88 1.88L13 18.17z"
                                  Fill="{StaticResource TextPrimaryBrush}"
                                  Stretch="Uniform"/>
                        </Viewbox>
                        <TextBlock Text="Bluetooth" Foreground="{StaticResource TextPrimaryBrush}" FontSize="13" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- USB -->
                <Border Width="96" Height="96"
                        Background="{StaticResource GlassCardBrush}"
                        CornerRadius="24"
                        Margin="8"
                        BorderThickness="1"
                        BorderBrush="{StaticResource GlassBorderBrush}"
                        MouseLeftButtonDown="Usb_Click"
                        Cursor="Hand">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="24" ShadowDepth="0" Color="#FFB74D" Opacity="{Binding UsbGlowOpacity}"/>
                    </Border.Effect>
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Viewbox Width="36" Height="36" Margin="0,0,0,4">
                            <Path Data="M15 7v4h1v2h-3V9h-1V7H9v2H7V7H5v4H4v2h1v2h2v2h2v2h2v-2h2v-2h2v-2h1V9h-1V7h-2zm-4 10h2v2h-2v-2zm4 0h2v2h-2v-2z"
                                  Fill="{StaticResource TextPrimaryBrush}"
                                  Stretch="Uniform"/>
                        </Viewbox>
                        <TextBlock Text="USB" Foreground="{StaticResource TextPrimaryBrush}" FontSize="13" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- CONTENT PANEL - glass -->
            <Border Grid.Row="3"
                    Background="{StaticResource GlassPanelBrush}"
                    CornerRadius="20"
                    Padding="20"
                    BorderThickness="1"
                    BorderBrush="{StaticResource GlassBorderBrush}">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.12" Color="Black"/>
                </Border.Effect>

                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                    <Grid>
                        <!-- WIFI: QR + How to connect -->
                        <StackPanel Visibility="{Binding WifiQrVisibility}">
                            <TextBlock Text="Scan with Mobile App"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       FontSize="13"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,10"/>
                            <Border Background="#30FFFFFF"
                                    CornerRadius="14"
                                    Padding="12"
                                    BorderThickness="1"
                                    BorderBrush="{StaticResource GlassBorderBrush}"
                                    Margin="0,0,0,20">
                                <Image Width="180" Height="180" Source="{Binding QrImage}"
                                       RenderOptions.BitmapScalingMode="HighQuality"
                                       HorizontalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="{Binding ConnectionString}"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       FontSize="10" Opacity="0.9" TextAlignment="Center"
                                       TextWrapping="Wrap" Margin="0,0,0,16"/>
                            <TextBlock Text="HOW TO CONNECT"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       FontSize="11" FontWeight="Bold" Margin="0,0,0,10"/>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentWifiBrush}"/>
                                        <TextBlock Text="1" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Ensure your phone and PC are on the same Wiâ€‘Fi network."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentWifiBrush}"/>
                                        <TextBlock Text="2" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Download Sim Gamepad on your PC and open it."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentWifiBrush}"/>
                                        <TextBlock Text="3" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Scan the QR code above with the Sim Gamepad mobile app."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentWifiBrush}"/>
                                        <TextBlock Text="4" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Select your PC from the app to connect."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>

                        <!-- BLUETOOTH: How to connect -->
                        <StackPanel Visibility="{Binding BluetoothInfoVisibility}">
                            <TextBlock Text="HOW TO CONNECT"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       FontSize="11" FontWeight="Bold" Margin="0,0,0,12"/>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentBluetoothBrush}"/>
                                        <TextBlock Text="1" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Enable Bluetooth on both your phone and PC."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentBluetoothBrush}"/>
                                        <TextBlock Text="2" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Download Sim Gamepad on your PC and open it."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentBluetoothBrush}"/>
                                        <TextBlock Text="3" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Make your PC discoverable in Bluetooth settings."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentBluetoothBrush}"/>
                                        <TextBlock Text="4" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Pair your phone with your PC."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentBluetoothBrush}"/>
                                        <TextBlock Text="5" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Select your PC from the app to connect."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>

                        <!-- USB: How to connect -->
                        <StackPanel Visibility="{Binding UsbInfoVisibility}">
                            <TextBlock Text="HOW TO CONNECT"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       FontSize="11" FontWeight="Bold" Margin="0,0,0,12"/>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentUsbBrush}"/>
                                        <TextBlock Text="1" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Enable Developer options on your phone."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentUsbBrush}"/>
                                        <TextBlock Text="2" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Enable USB debugging in Developer options."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentUsbBrush}"/>
                                        <TextBlock Text="3" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Download Sim Gamepad on your PC and open it."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentUsbBrush}"/>
                                        <TextBlock Text="4" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Connect your phone to your PC with a USB cable."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Grid Width="20" Height="20" Margin="0,0,10,0">
                                        <Ellipse Fill="{StaticResource AccentUsbBrush}"/>
                                        <TextBlock Text="5" Foreground="#1a1a1a" FontWeight="Bold" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Allow USB debugging when prompted on your phone."
                                               Foreground="{StaticResource TextPrimaryBrush}" FontSize="12"
                                               TextWrapping="Wrap" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </Border>
        </Grid>
    </Border>
</Window>
